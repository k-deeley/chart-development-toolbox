<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
<!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      -->
<title>LineSelectorChart</title>
<meta name="generator" content="MATLAB 25.1">
<link rel="schema.DC" href="http://purl.org/dc/elements/1.1/">
<meta name="DC.date" content="2025-01-11">
<meta name="DC.source" content="LineSelectorChart.m">
<style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; }

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }
span.typesection { color:#A0522D }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style>
</head>
<body>
<div class="content">
<pre class="codeinput">
<span class="keyword">classdef</span> LineSelectorChart &lt; Chart
    <span class="comment">%LINESELECTORCHART Chart displaying a collection of line plots,</span>
    <span class="comment">%possibly on different scales.</span>

    <span class="comment">% Copyright 2018-2025 The MathWorks, Inc.</span>

    <span class="keyword">properties</span> ( Dependent )
        <span class="comment">% Chart x-data.</span>
        XData<span class="typesection">(:, 1) double {mustBeReal}</span>
        <span class="comment">% Chart y-data.</span>
        YData<span class="typesection">(:, :) double {mustBeReal}</span>
    <span class="keyword">end</span> <span class="comment">% properties ( Dependent )</span>

    <span class="keyword">properties</span>
        <span class="comment">% Axes x-grid.</span>
        XGrid<span class="typesection">(1, 1) matlab.lang.OnOffSwitchState </span>= <span class="string">"on"</span>
        <span class="comment">% Axes y-grid.</span>
        YGrid<span class="typesection">(1, 1) matlab.lang.OnOffSwitchState </span>= <span class="string">"on"</span>
        <span class="comment">% Color of the selected line.</span>
        SelectedColor <span class="typesection">{validatecolor}</span> = [0, 0.447, 0.741]
        <span class="comment">% Width of the selected line.</span>
        SelectedLineWidth<span class="typesection">(1, 1) double {mustBePositive, mustBeFinite}</span> = 3
        <span class="comment">% Width of the unselected lines.</span>
        TraceLineWidth<span class="typesection">(1, 1) double {mustBePositive, mustBeFinite}</span> = 1.5
    <span class="keyword">end</span> <span class="comment">% properties</span>

    <span class="keyword">properties</span> ( Dependent )
        <span class="comment">% Color of the unselected line or lines.</span>
        TraceColor
    <span class="keyword">end</span> <span class="comment">% properties ( Dependent )</span>

    <span class="keyword">properties</span> ( Access = private )
        <span class="comment">% Internal storage for the XData property.</span>
        XData_<span class="typesection">(:, 1) double {mustBeReal}</span> = double.empty( 0, 1 )
        <span class="comment">% Internal storage for the YData property.</span>
        YData_<span class="typesection">(:, :) double {mustBeReal}</span> = double.empty( 0, 1 )
        <span class="comment">% Index of the selected line.</span>
        SelectedLineIndex<span class="typesection">(1, 1) double </span><span class="keyword">...</span>
            <span class="typesection">{mustBeNonnegative, mustBeInteger}</span> = 0
        <span class="comment">% Internal storage for the TraceColor property.</span>
        TraceColor_<span class="typesection">(1, 3) double </span><span class="keyword">...</span>
            <span class="typesection">{mustBeInRange( TraceColor_, 0, 1 )}</span> = [0.5, 0.5, 0.5]
        <span class="comment">% Logical scalar specifying whether a computation is required.</span>
        ComputationRequired<span class="typesection">(1, 1) logical </span>= false
    <span class="keyword">end</span> <span class="comment">% properties ( Access = private )</span>

    <span class="keyword">properties</span> ( Dependent, Access = private )
        <span class="comment">% Chart y-data, rescaled columnwise to lie in the range [0, 1].</span>
        YDataScaled<span class="typesection">(:, :) double {mustBeReal}</span>
        <span class="comment">% Columnwise ranges.</span>
        YDataRange<span class="typesection">(1, :) double {mustBeReal}</span>
        <span class="comment">% Columnwise minima.</span>
        YDataMin<span class="typesection">(1, :) double {mustBeReal}</span>
    <span class="keyword">end</span> <span class="comment">% properties ( Dependent, Access = private )</span>

    <span class="keyword">properties</span> ( Access = private, Transient, NonCopyable )
        <span class="comment">% Chart axes.</span>
        Axes<span class="typesection">(:, 1) matlab.graphics.axis.Axes {mustBeScalarOrEmpty}</span>
        <span class="comment">% Reset button.</span>
        ResetButton<span class="typesection">(:, 1) matlab.ui.controls.ToolbarPushButton </span><span class="keyword">...</span>
            <span class="typesection">{mustBeScalarOrEmpty}</span>
        <span class="comment">% Line objects.</span>
        Lines<span class="typesection">(:, 1) matlab.graphics.primitive.Line</span>
    <span class="keyword">end</span> <span class="comment">% properties ( Access = private, Transient, NonCopyable )</span>

    <span class="keyword">properties</span> ( Constant, Hidden )
        <span class="comment">% Product dependencies.</span>
        Dependencies<span class="typesection">(1, :) string </span>= <span class="string">"MATLAB"</span>
        <span class="comment">% Description.</span>
        ShortDescription<span class="typesection">(1, 1) string </span>= <span class="string">"Display a collection of "</span> + <span class="keyword">...</span>
            <span class="string">"line plots and select one to highlight"</span>
    <span class="keyword">end</span> <span class="comment">% properties ( Constant, Hidden )</span>

    <span class="keyword">methods</span>

        <span class="keyword">function</span> value = get.XData( obj )

            value = obj.XData_;

        <span class="keyword">end</span> <span class="comment">% get.XData</span>

        <span class="keyword">function</span> set.XData( obj, value )

            <span class="comment">% Mark the chart for an update.</span>
            obj.ComputationRequired = true;

            <span class="comment">% Decide how to modify the chart data.</span>
            nX = numel( value );
            nY = height( obj.YData_ );

            <span class="keyword">if</span> nX &lt; nY
                <span class="comment">% Truncate the y-data if the new x-data is shorter.</span>
                obj.YData_(nX+1:end, :) = [];
            <span class="keyword">else</span>
                <span class="comment">% Otherwise, pad the y-data with NaNs.</span>
                obj.YData_(end+1:nX, :) = NaN();
            <span class="keyword">end</span> <span class="comment">% if</span>

            <span class="comment">% Set the internal x-data.</span>
            obj.XData_ = value;

        <span class="keyword">end</span> <span class="comment">% set.XData</span>

        <span class="keyword">function</span> value = get.YData( obj )

            value = obj.YData_;

        <span class="keyword">end</span> <span class="comment">% get.YData</span>

        <span class="keyword">function</span> set.YData( obj, value )

            <span class="comment">% Mark the chart for an update.</span>
            obj.ComputationRequired = true;

            <span class="comment">% Decide how to modify the chart data.</span>
            nX = numel( obj.XData_ );
            nY = height( value );

            <span class="keyword">if</span> nY &lt; nX
                <span class="comment">% Truncate the x-data if the new y-data is shorter.</span>
                obj.XData_(nY+1:end) = [];
            <span class="keyword">else</span>
                <span class="comment">% Otherwise, pad the x-data with NaNs.</span>
                obj.XData_(end+1:nY) = NaN();
            <span class="keyword">end</span> <span class="comment">% if</span>

            <span class="comment">% Set the internal y-data.</span>
            <span class="keyword">if</span> isvector( value )
                obj.YData_ = value(:);
            <span class="keyword">else</span>
                obj.YData_ = value;
            <span class="keyword">end</span> <span class="comment">% if</span>

        <span class="keyword">end</span> <span class="comment">% set.YData</span>

        <span class="keyword">function</span> value = get.YDataScaled( obj )

            value = (obj.YData_ - obj.YDataMin) ./ obj.YDataRange;

        <span class="keyword">end</span> <span class="comment">% get.YDataScaled</span>

        <span class="keyword">function</span> value = get.YDataRange( obj )

            value = max( obj.YData_, [], 1 ) - obj.YDataMin;

        <span class="keyword">end</span> <span class="comment">% get.YDataRange</span>

        <span class="keyword">function</span> value = get.YDataMin( obj )

            value = min( obj.YData_, [], 1 );

        <span class="keyword">end</span> <span class="comment">% get.YDataMin</span>

        <span class="keyword">function</span> value = get.TraceColor( obj )

            value = obj.TraceColor_;

        <span class="keyword">end</span> <span class="comment">% get.TraceColor</span>

        <span class="keyword">function</span> set.TraceColor( obj, value )

            <span class="comment">% Set the property value.</span>
            obj.TraceColor_ = validatecolor( value );

            <span class="comment">% Update the unselected line(s) if necessary.</span>
            unselectedLineIdx = setdiff( 1:numel( obj.Lines ), <span class="keyword">...</span>
                obj.SelectedLineIndex );
            set( obj.Lines(unselectedLineIdx), <span class="string">"Color"</span>, value )

        <span class="keyword">end</span> <span class="comment">% set.TraceColor</span>

    <span class="keyword">end</span> <span class="comment">% methods</span>

    <span class="keyword">methods</span>

        <span class="keyword">function</span> obj = LineSelectorChart( namedArgs )
            <span class="comment">%LINESELECTORCHART Construct a LineSelectorChart, given</span>
            <span class="comment">%optional name-value arguments.</span>

            <span class="keyword">arguments</span> ( Input )
                namedArgs.?LineSelectorChart
            <span class="keyword">end</span> <span class="comment">% arguments ( Input )</span>

            <span class="comment">% Set any user-defined properties.</span>
            set( obj, namedArgs )

        <span class="keyword">end</span> <span class="comment">% constructor</span>

        <span class="keyword">function</span> varargout = xlabel( obj, varargin )

            [varargout{1:nargout}] = xlabel( obj.Axes, varargin{:} );

        <span class="keyword">end</span> <span class="comment">% xlabel</span>

        <span class="keyword">function</span> varargout = ylabel( obj, varargin )

            [varargout{1:nargout}] = ylabel( obj.Axes, varargin{:} );

        <span class="keyword">end</span> <span class="comment">% ylabel</span>

        <span class="keyword">function</span> varargout = title( obj, varargin )

            [varargout{1:nargout}] = title( obj.Axes, varargin{:} );

        <span class="keyword">end</span> <span class="comment">% title</span>

        <span class="keyword">function</span> grid( obj, varargin )

            <span class="comment">% Invoke grid on the axes.</span>
            grid( obj.Axes, varargin{:} )
            <span class="comment">% Update the chart's decorative properties.</span>
            obj.XGrid = obj.Axes.XGrid;
            obj.YGrid = obj.Axes.YGrid;

        <span class="keyword">end</span> <span class="comment">% grid</span>

        <span class="keyword">function</span> varargout = legend( obj, varargin )

            <span class="comment">% Invoke legend on the axes.</span>
            [varargout{1:nargout}] = legend( obj.Axes, varargin{:} );

            <span class="comment">% Reconnect the ItemHitFcn, if necessary.</span>
            <span class="keyword">if</span> ~isempty( obj.Axes.Legend )
                obj.Axes.Legend.ItemHitFcn = @obj.onLegendClicked;
            <span class="keyword">end</span> <span class="comment">% if</span>

        <span class="keyword">end</span> <span class="comment">% legend</span>

        <span class="keyword">function</span> varargout = xlim( obj, varargin )

            [varargout{1:nargout}] = xlim( obj.Axes, varargin{:} );

        <span class="keyword">end</span> <span class="comment">% xlim</span>

        <span class="keyword">function</span> varargout = ylim( obj, varargin )

            [varargout{1:nargout}] = ylim( obj.Axes, varargin{:} );

        <span class="keyword">end</span> <span class="comment">% ylim</span>

        <span class="keyword">function</span> varargout = axis( obj, varargin )

            [varargout{1:nargout}] = axis( obj.Axes, varargin{:} );

        <span class="keyword">end</span> <span class="comment">% axis</span>

        <span class="keyword">function</span> select( obj, lineIndex )
            <span class="comment">%SELECT Select a line.</span>

            <span class="keyword">arguments</span> ( Input )
                obj<span class="typesection">(1, 1) LineSelectorChart</span>
                lineIndex<span class="typesection">(1, 1) double {mustBeNonnegative, mustBeInteger}</span>
            <span class="keyword">end</span> <span class="comment">% arguments ( Input )</span>

            <span class="keyword">if</span> lineIndex == 0

                <span class="comment">% Reset the chart if no selection is made.</span>
                obj.deselect()

            <span class="keyword">else</span>

                <span class="comment">% Otherwise, check the proposed value.</span>
                numLines = numel( obj.Lines );
                assert( lineIndex &lt;= numLines, <span class="keyword">...</span>
                    <span class="string">"LineSelectorChart:InvalidLineIndex"</span>, <span class="keyword">...</span>
                    <span class="string">"The line index must be a nonnegative scalar"</span> + <span class="keyword">...</span>
                    <span class="string">" integer not exceeding the number of lines, %d."</span>, <span class="keyword">...</span>
                    numLines )

                <span class="comment">% Set the internal value.</span>
                obj.SelectedLineIndex = lineIndex;

                <span class="comment">% Update the line color.</span>
                obj.Lines(obj.SelectedLineIndex).Color = obj.SelectedColor;
                obj.Axes.YColor = obj.SelectedColor;

                <span class="comment">% Trigger the line selected callback.</span>
                onLineClicked( obj, obj.Lines(obj.SelectedLineIndex) )

            <span class="keyword">end</span> <span class="comment">% if</span>

        <span class="keyword">end</span> <span class="comment">% select</span>

        <span class="keyword">function</span> deselect( obj )
            <span class="comment">%DESELECT Deselect the selected line if one is selected.</span>

            <span class="comment">% Enable interactivity and gray out all lines.</span>
            set( obj.Lines, <span class="string">"ButtonDownFcn"</span>, @obj.onLineClicked, <span class="keyword">...</span>
                <span class="string">"LineWidth"</span>, obj.TraceLineWidth, <span class="keyword">...</span>
                <span class="string">"Color"</span>, obj.TraceColor )

            <span class="comment">% Restore the original y-axis color.</span>
            obj.Axes.YColor = obj.Axes.XColor;

            <span class="comment">% Record no selection.</span>
            obj.SelectedLineIndex = 0;

        <span class="keyword">end</span> <span class="comment">% deselect</span>

    <span class="keyword">end</span> <span class="comment">% methods</span>

    <span class="keyword">methods</span> ( Access = protected )

        <span class="keyword">function</span> setup( obj )
            <span class="comment">%SETUP Initialize the chart graphics.</span>

            <span class="comment">% Create the chart's axes.</span>
            obj.Axes = axes( <span class="string">"Parent"</span>, obj.getLayout() );

            <span class="comment">% Add a push button to reset the chart.</span>
            tb = axtoolbar( obj.Axes, <span class="string">"default"</span> );
            iconPath = fullfile( chartsRoot(), <span class="string">"charts"</span>, <span class="keyword">...</span>
                <span class="string">"images"</span>, <span class="string">"Reset.png"</span> );
            obj.ResetButton = axtoolbarbtn( tb, <span class="string">"push"</span>, <span class="keyword">...</span>
                <span class="string">"Icon"</span>, iconPath, <span class="keyword">...</span>
                <span class="string">"Tooltip"</span>, <span class="string">"Reset the chart"</span>, <span class="keyword">...</span>
                <span class="string">"ButtonPushedFcn"</span>, @obj.onResetButtonPushed );

        <span class="keyword">end</span> <span class="comment">% setup</span>

        <span class="keyword">function</span> update( obj )
            <span class="comment">%UPDATE Refresh the chart graphics.</span>

            <span class="keyword">if</span> obj.ComputationRequired

                <span class="comment">% Count the number of lines required.</span>
                nNew = width( obj.YData_ );

                <span class="comment">% Count the number of existing lines.</span>
                nOld = numel( obj.Lines );

                <span class="keyword">if</span> nNew &gt; nOld
                    <span class="comment">% Create new lines.</span>
                    nToCreate = nNew - nOld;
                    <span class="keyword">for</span> k = 1 : nToCreate
                        obj.Lines(nOld+k) = line( <span class="keyword">...</span>
                            obj.Axes, NaN, NaN, <span class="keyword">...</span>
                            <span class="string">"Color"</span>, obj.TraceColor, <span class="keyword">...</span>
                            <span class="string">"DisplayName"</span>, <span class="string">""</span> );
                    <span class="keyword">end</span> <span class="comment">% for</span>
                <span class="keyword">elseif</span> nNew &lt; nOld
                    <span class="comment">% Remove the unnecessary lines.</span>
                    delete( obj.Lines(nNew+1:nOld) );
                    obj.Lines(nNew+1:nOld) = [];
                <span class="keyword">end</span> <span class="comment">% if</span>

                <span class="comment">% Update the data for all lines.</span>
                <span class="keyword">for</span> k = 1:nNew
                    set( obj.Lines(k), <span class="string">"XData"</span>, obj.XData_, <span class="keyword">...</span>
                        <span class="string">"YData"</span>, obj.YDataScaled(:, k) )
                <span class="keyword">end</span> <span class="comment">% for</span>

                <span class="comment">% Enable interactivity and gray out all lines.</span>
                deselect( obj )

                <span class="comment">% Mark the chart clean.</span>
                obj.ComputationRequired = false;

            <span class="keyword">end</span> <span class="comment">% if</span>

            <span class="comment">% Refresh the chart's decorative properties.</span>
            set( obj.Axes, <span class="string">"XGrid"</span>, obj.XGrid, <span class="keyword">...</span>
                <span class="string">"YGrid"</span>, obj.YGrid )
            set( obj.Lines, <span class="string">"LineWidth"</span>, obj.TraceLineWidth )
            <span class="keyword">if</span> obj.SelectedLineIndex &gt; 0
                obj.Lines(obj.SelectedLineIndex).LineWidth = <span class="keyword">...</span>
                    obj.SelectedLineWidth;
            <span class="keyword">end</span> <span class="comment">% if</span>

        <span class="keyword">end</span> <span class="comment">% update</span>

    <span class="keyword">end</span> <span class="comment">% methods ( Access = protected )</span>

    <span class="keyword">methods</span> ( Access = private )

        <span class="keyword">function</span> onResetButtonPushed( obj, ~, ~ )
            <span class="comment">%ONRESETBUTTONPUSHED Reset the chart when the user pushes the</span>
            <span class="comment">%reset button on the axes' toolbar.</span>

            deselect( obj )

        <span class="keyword">end</span> <span class="comment">% onResetButtonPushed</span>

        <span class="keyword">function</span> onLineClicked( obj, s, ~ )

            <span class="comment">% Determine the index of the selected line.</span>
            selectedIdx = find( obj.Lines == s );

            <span class="comment">% Record this value in the object.</span>
            obj.SelectedLineIndex = selectedIdx;

            <span class="comment">% Gray out all lines.</span>
            set( obj.Lines, <span class="string">"LineWidth"</span>, obj.TraceLineWidth, <span class="keyword">...</span>
                <span class="string">"Color"</span>, obj.TraceColor )

            <span class="comment">% Highlight the selected line.</span>
            set( obj.Lines(selectedIdx), <span class="keyword">...</span>
                <span class="string">"LineWidth"</span>, obj.TraceLineWidth, <span class="keyword">...</span>
                <span class="string">"Color"</span>, obj.SelectedColor, <span class="keyword">...</span>
                <span class="string">"YData"</span>, obj.YData_(:, selectedIdx) )
            set( obj.Axes, <span class="string">"YColor"</span>, obj.SelectedColor )

            <span class="comment">% Adjust the y-data for all other lines.</span>
            notSelectedIdx = setdiff( 1:numel( obj.Lines ), selectedIdx );
            <span class="keyword">for</span> k = notSelectedIdx
                adjustedYData = obj.YDataScaled(:, k) * <span class="keyword">...</span>
                    obj.YDataRange(selectedIdx) + <span class="keyword">...</span>
                    obj.YDataMin(selectedIdx);
                set( obj.Lines(k), <span class="string">"YData"</span>, adjustedYData )
            <span class="keyword">end</span> <span class="comment">% for</span>

        <span class="keyword">end</span> <span class="comment">% onLineClicked</span>

        <span class="keyword">function</span> onLegendClicked( obj, ~, e )

            onLineClicked( obj, e.Peer )

        <span class="keyword">end</span> <span class="comment">% onLegendClicked</span>

    <span class="keyword">end</span> <span class="comment">% methods ( Access = private )</span>

<span class="keyword">end</span> <span class="comment">% classdef</span>
</pre>
</div>
<!--
##### SOURCE BEGIN #####
classdef LineSelectorChart < Chart
    %LINESELECTORCHART Chart displaying a collection of line plots,
    %possibly on different scales.

    % Copyright 2018-2025 The MathWorks, Inc.

    properties ( Dependent )
        % Chart x-data.
        XData(:, 1) double {mustBeReal}
        % Chart y-data.
        YData(:, :) double {mustBeReal}
    end % properties ( Dependent )

    properties
        % Axes x-grid.
        XGrid(1, 1) matlab.lang.OnOffSwitchState = "on"
        % Axes y-grid.
        YGrid(1, 1) matlab.lang.OnOffSwitchState = "on"
        % Color of the selected line.
        SelectedColor {validatecolor} = [0, 0.447, 0.741]
        % Width of the selected line.
        SelectedLineWidth(1, 1) double {mustBePositive, mustBeFinite} = 3
        % Width of the unselected lines.
        TraceLineWidth(1, 1) double {mustBePositive, mustBeFinite} = 1.5
    end % properties

    properties ( Dependent )
        % Color of the unselected line or lines.
        TraceColor
    end % properties ( Dependent )

    properties ( Access = private )
        % Internal storage for the XData property.
        XData_(:, 1) double {mustBeReal} = double.empty( 0, 1 )
        % Internal storage for the YData property.
        YData_(:, :) double {mustBeReal} = double.empty( 0, 1 )
        % Index of the selected line.
        SelectedLineIndex(1, 1) double ...
            {mustBeNonnegative, mustBeInteger} = 0
        % Internal storage for the TraceColor property.
        TraceColor_(1, 3) double ...
            {mustBeInRange( TraceColor_, 0, 1 )} = [0.5, 0.5, 0.5]
        % Logical scalar specifying whether a computation is required.
        ComputationRequired(1, 1) logical = false
    end % properties ( Access = private )

    properties ( Dependent, Access = private )
        % Chart y-data, rescaled columnwise to lie in the range [0, 1].
        YDataScaled(:, :) double {mustBeReal}
        % Columnwise ranges.
        YDataRange(1, :) double {mustBeReal}
        % Columnwise minima.
        YDataMin(1, :) double {mustBeReal}
    end % properties ( Dependent, Access = private )

    properties ( Access = private, Transient, NonCopyable )
        % Chart axes.
        Axes(:, 1) matlab.graphics.axis.Axes {mustBeScalarOrEmpty}
        % Reset button.
        ResetButton(:, 1) matlab.ui.controls.ToolbarPushButton ...
            {mustBeScalarOrEmpty}
        % Line objects.
        Lines(:, 1) matlab.graphics.primitive.Line
    end % properties ( Access = private, Transient, NonCopyable )

    properties ( Constant, Hidden )
        % Product dependencies.
        Dependencies(1, :) string = "MATLAB"
        % Description.
        ShortDescription(1, 1) string = "Display a collection of " + ...
            "line plots and select one to highlight"
    end % properties ( Constant, Hidden )

    methods

        function value = get.XData( obj )

            value = obj.XData_;

        end % get.XData

        function set.XData( obj, value )

            % Mark the chart for an update.
            obj.ComputationRequired = true;

            % Decide how to modify the chart data.
            nX = numel( value );
            nY = height( obj.YData_ );

            if nX < nY
                % Truncate the y-data if the new x-data is shorter.
                obj.YData_(nX+1:end, :) = [];
            else
                % Otherwise, pad the y-data with NaNs.
                obj.YData_(end+1:nX, :) = NaN();
            end % if

            % Set the internal x-data.
            obj.XData_ = value;

        end % set.XData

        function value = get.YData( obj )

            value = obj.YData_;

        end % get.YData

        function set.YData( obj, value )

            % Mark the chart for an update.
            obj.ComputationRequired = true;

            % Decide how to modify the chart data.
            nX = numel( obj.XData_ );
            nY = height( value );

            if nY < nX
                % Truncate the x-data if the new y-data is shorter.
                obj.XData_(nY+1:end) = [];
            else
                % Otherwise, pad the x-data with NaNs.
                obj.XData_(end+1:nY) = NaN();
            end % if

            % Set the internal y-data.
            if isvector( value )
                obj.YData_ = value(:);
            else
                obj.YData_ = value;
            end % if

        end % set.YData

        function value = get.YDataScaled( obj )

            value = (obj.YData_ - obj.YDataMin) ./ obj.YDataRange;

        end % get.YDataScaled

        function value = get.YDataRange( obj )

            value = max( obj.YData_, [], 1 ) - obj.YDataMin;

        end % get.YDataRange

        function value = get.YDataMin( obj )

            value = min( obj.YData_, [], 1 );

        end % get.YDataMin

        function value = get.TraceColor( obj )

            value = obj.TraceColor_;

        end % get.TraceColor

        function set.TraceColor( obj, value )

            % Set the property value.
            obj.TraceColor_ = validatecolor( value );

            % Update the unselected line(s) if necessary.
            unselectedLineIdx = setdiff( 1:numel( obj.Lines ), ...
                obj.SelectedLineIndex );
            set( obj.Lines(unselectedLineIdx), "Color", value )

        end % set.TraceColor

    end % methods

    methods

        function obj = LineSelectorChart( namedArgs )
            %LINESELECTORCHART Construct a LineSelectorChart, given
            %optional name-value arguments.

            arguments ( Input )
                namedArgs.?LineSelectorChart
            end % arguments ( Input )

            % Set any user-defined properties.
            set( obj, namedArgs )

        end % constructor

        function varargout = xlabel( obj, varargin )

            [varargout{1:nargout}] = xlabel( obj.Axes, varargin{:} );

        end % xlabel

        function varargout = ylabel( obj, varargin )

            [varargout{1:nargout}] = ylabel( obj.Axes, varargin{:} );

        end % ylabel

        function varargout = title( obj, varargin )

            [varargout{1:nargout}] = title( obj.Axes, varargin{:} );

        end % title

        function grid( obj, varargin )

            % Invoke grid on the axes.
            grid( obj.Axes, varargin{:} )
            % Update the chart's decorative properties.
            obj.XGrid = obj.Axes.XGrid;
            obj.YGrid = obj.Axes.YGrid;

        end % grid

        function varargout = legend( obj, varargin )

            % Invoke legend on the axes.
            [varargout{1:nargout}] = legend( obj.Axes, varargin{:} );

            % Reconnect the ItemHitFcn, if necessary.
            if ~isempty( obj.Axes.Legend )
                obj.Axes.Legend.ItemHitFcn = @obj.onLegendClicked;
            end % if

        end % legend

        function varargout = xlim( obj, varargin )

            [varargout{1:nargout}] = xlim( obj.Axes, varargin{:} );

        end % xlim

        function varargout = ylim( obj, varargin )

            [varargout{1:nargout}] = ylim( obj.Axes, varargin{:} );

        end % ylim

        function varargout = axis( obj, varargin )

            [varargout{1:nargout}] = axis( obj.Axes, varargin{:} );

        end % axis

        function select( obj, lineIndex )
            %SELECT Select a line.

            arguments ( Input )
                obj(1, 1) LineSelectorChart
                lineIndex(1, 1) double {mustBeNonnegative, mustBeInteger}
            end % arguments ( Input )

            if lineIndex == 0

                % Reset the chart if no selection is made.
                obj.deselect()

            else

                % Otherwise, check the proposed value.
                numLines = numel( obj.Lines );
                assert( lineIndex <= numLines, ...
                    "LineSelectorChart:InvalidLineIndex", ...
                    "The line index must be a nonnegative scalar" + ...
                    " integer not exceeding the number of lines, %d.", ...
                    numLines )

                % Set the internal value.
                obj.SelectedLineIndex = lineIndex;

                % Update the line color.
                obj.Lines(obj.SelectedLineIndex).Color = obj.SelectedColor;
                obj.Axes.YColor = obj.SelectedColor;

                % Trigger the line selected callback.
                onLineClicked( obj, obj.Lines(obj.SelectedLineIndex) )

            end % if

        end % select

        function deselect( obj )
            %DESELECT Deselect the selected line if one is selected.

            % Enable interactivity and gray out all lines.
            set( obj.Lines, "ButtonDownFcn", @obj.onLineClicked, ...
                "LineWidth", obj.TraceLineWidth, ...
                "Color", obj.TraceColor )

            % Restore the original y-axis color.
            obj.Axes.YColor = obj.Axes.XColor;

            % Record no selection.
            obj.SelectedLineIndex = 0;

        end % deselect

    end % methods

    methods ( Access = protected )

        function setup( obj )
            %SETUP Initialize the chart graphics.

            % Create the chart's axes.
            obj.Axes = axes( "Parent", obj.getLayout() );

            % Add a push button to reset the chart.
            tb = axtoolbar( obj.Axes, "default" );
            iconPath = fullfile( chartsRoot(), "charts", ...
                "images", "Reset.png" );
            obj.ResetButton = axtoolbarbtn( tb, "push", ...
                "Icon", iconPath, ...
                "Tooltip", "Reset the chart", ...
                "ButtonPushedFcn", @obj.onResetButtonPushed );

        end % setup

        function update( obj )
            %UPDATE Refresh the chart graphics.

            if obj.ComputationRequired

                % Count the number of lines required.
                nNew = width( obj.YData_ );

                % Count the number of existing lines.
                nOld = numel( obj.Lines );

                if nNew > nOld
                    % Create new lines.
                    nToCreate = nNew - nOld;
                    for k = 1 : nToCreate
                        obj.Lines(nOld+k) = line( ...
                            obj.Axes, NaN, NaN, ...
                            "Color", obj.TraceColor, ...
                            "DisplayName", "" );
                    end % for
                elseif nNew < nOld
                    % Remove the unnecessary lines.
                    delete( obj.Lines(nNew+1:nOld) );
                    obj.Lines(nNew+1:nOld) = [];
                end % if

                % Update the data for all lines.
                for k = 1:nNew
                    set( obj.Lines(k), "XData", obj.XData_, ...
                        "YData", obj.YDataScaled(:, k) )
                end % for

                % Enable interactivity and gray out all lines.
                deselect( obj )

                % Mark the chart clean.
                obj.ComputationRequired = false;

            end % if

            % Refresh the chart's decorative properties.
            set( obj.Axes, "XGrid", obj.XGrid, ...
                "YGrid", obj.YGrid )
            set( obj.Lines, "LineWidth", obj.TraceLineWidth )
            if obj.SelectedLineIndex > 0
                obj.Lines(obj.SelectedLineIndex).LineWidth = ...
                    obj.SelectedLineWidth;
            end % if

        end % update

    end % methods ( Access = protected )

    methods ( Access = private )

        function onResetButtonPushed( obj, ~, ~ )
            %ONRESETBUTTONPUSHED Reset the chart when the user pushes the
            %reset button on the axes' toolbar.

            deselect( obj )

        end % onResetButtonPushed

        function onLineClicked( obj, s, ~ )

            % Determine the index of the selected line.
            selectedIdx = find( obj.Lines == s );

            % Record this value in the object.
            obj.SelectedLineIndex = selectedIdx;

            % Gray out all lines.
            set( obj.Lines, "LineWidth", obj.TraceLineWidth, ...
                "Color", obj.TraceColor )

            % Highlight the selected line.
            set( obj.Lines(selectedIdx), ...
                "LineWidth", obj.TraceLineWidth, ...
                "Color", obj.SelectedColor, ...
                "YData", obj.YData_(:, selectedIdx) )
            set( obj.Axes, "YColor", obj.SelectedColor )

            % Adjust the y-data for all other lines.
            notSelectedIdx = setdiff( 1:numel( obj.Lines ), selectedIdx );
            for k = notSelectedIdx
                adjustedYData = obj.YDataScaled(:, k) * ...
                    obj.YDataRange(selectedIdx) + ...
                    obj.YDataMin(selectedIdx);
                set( obj.Lines(k), "YData", adjustedYData )
            end % for

        end % onLineClicked

        function onLegendClicked( obj, ~, e )

            onLineClicked( obj, e.Peer )

        end % onLegendClicked

    end % methods ( Access = private )

end % classdef
##### SOURCE END #####
-->
</body>
</html>
