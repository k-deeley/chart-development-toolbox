<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
<!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      -->
<title>RangefinderChart</title>
<meta name="generator" content="MATLAB 25.1">
<link rel="schema.DC" href="http://purl.org/dc/elements/1.1/">
<meta name="DC.date" content="2025-01-11">
<meta name="DC.source" content="RangefinderChart.m">
<style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; }

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }
span.typesection { color:#A0522D }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style>
</head>
<body>
<div class="content">
<pre class="codeinput">
<span class="keyword">classdef</span> RangefinderChart &lt; Chart
    <span class="comment">%RANGEFINDERCHART Rangefinder chart for bivariate scattered data.</span>
    <span class="comment">%The rangefinder chart displays a 2D scatter plot overlaid with a</span>
    <span class="comment">%marker at the crossover point of the marginal medians and lines</span>
    <span class="comment">%indicating the marginal adjacent values.</span>

    <span class="comment">% Copyright 2018-2025 The MathWorks, Inc.</span>

    <span class="keyword">properties</span> ( Dependent )
        <span class="comment">% Chart x-data.</span>
        XData<span class="typesection">(:, 1) double {mustBeReal}</span>
        <span class="comment">% Chart y-data.</span>
        YData<span class="typesection">(:, 1) double {mustBeReal}</span>
    <span class="keyword">end</span> <span class="comment">% properties ( Dependent )</span>

    <span class="keyword">properties</span>
        <span class="comment">% Marker for the discrete plot.</span>
        Marker<span class="typesection">(1, 1) string {mustBeMarker}</span> = <span class="string">"o"</span>
        <span class="comment">% Size data for the discrete plot.</span>
        SizeData<span class="typesection">(:, 1) double {mustBePositive, mustBeFinite}</span> = 36
        <span class="comment">% Color of the discrete plot.</span>
        CData<span class="typesection">(:, 3) double {mustBeInRange( CData, 0, 1 )}</span> = <span class="keyword">...</span>
            [0, 0.4470, 0.7410]
        <span class="comment">% Axes x-grid.</span>
        XGrid<span class="typesection">(1, 1) matlab.lang.OnOffSwitchState </span>= <span class="string">"on"</span>
        <span class="comment">% Axes y-grid.</span>
        YGrid<span class="typesection">(1, 1) matlab.lang.OnOffSwitchState </span>= <span class="string">"on"</span>
        <span class="comment">% Width of the adjacent lines.</span>
        LineWidth<span class="typesection">(1, 1) double {mustBePositive, mustBeFinite}</span> = 3
    <span class="keyword">end</span> <span class="comment">% properties</span>

    <span class="keyword">properties</span> ( Access = private )
        <span class="comment">% Internal storage for the XData property.</span>
        XData_<span class="typesection">(:, 1) double {mustBeReal}</span> = double.empty( 0, 1 )
        <span class="comment">% Internal storage for the YData property.</span>
        YData_<span class="typesection">(:, 1) double {mustBeReal}</span> = double.empty( 0, 1 )
        <span class="comment">% Logical scalar specifying whether a computation is required.</span>
        ComputationRequired<span class="typesection">(1, 1) logical </span>= false
    <span class="keyword">end</span> <span class="comment">% properties ( Access = private )</span>

    <span class="keyword">properties</span> ( Access = private, Transient, NonCopyable )
        <span class="comment">% Chart axes.</span>
        Axes<span class="typesection">(:, 1) matlab.graphics.axis.Axes {mustBeScalarOrEmpty}</span>
        <span class="comment">% Scatter series for the discrete bivariate data.</span>
        ScatterSeries<span class="typesection">(:, 1) matlab.graphics.chart.primitive.Scatter </span><span class="keyword">...</span>
            <span class="typesection">{mustBeScalarOrEmpty}</span>
        <span class="comment">% Line objects used for the median crossover.</span>
        MedianCrossoverLines<span class="typesection">(4, 1) matlab.graphics.primitive.Line</span>
        <span class="comment">% Line objects used for the adjacent values.</span>
        AdjacentLines<span class="typesection">(4, 1) matlab.graphics.chart.primitive.Line</span>
    <span class="keyword">end</span> <span class="comment">% properties ( Access = private, Transient, NonCopyable )</span>

    <span class="keyword">properties</span> ( Constant, Hidden )
        <span class="comment">% Product dependencies.</span>
        Dependencies<span class="typesection">(1, :) string </span>= [<span class="string">"MATLAB"</span>, <span class="keyword">...</span>
            <span class="string">"Statistics and Machine Learning Toolbox"</span>]
        <span class="comment">% Description.</span>
        ShortDescription<span class="typesection">(1, 1) string </span>= <span class="string">"Bivariate scatter plot "</span> + <span class="keyword">...</span>
            <span class="string">"showing the crossover point of the marginal medians"</span> + <span class="keyword">...</span>
            <span class="string">" and lines indicating the marginal adjacent values"</span>
    <span class="keyword">end</span> <span class="comment">% properties ( Constant, Hidden )</span>

    <span class="keyword">methods</span>

        <span class="keyword">function</span> value = get.XData( obj )

            value = obj.XData_;

        <span class="keyword">end</span> <span class="comment">% get.XData</span>

        <span class="keyword">function</span> set.XData( obj, value )

            <span class="comment">% Mark the chart for an update.</span>
            obj.ComputationRequired = true;

            <span class="comment">% Decide how to modify the chart data.</span>
            nX = numel( value );
            nY = numel( obj.YData_ );

            <span class="keyword">if</span> nX &lt; nY <span class="comment">% If the new x-data is too short ...</span>
                <span class="comment">% ... then chop the chart y-data.</span>
                obj.YData_ = obj.YData_(1:nX);
            <span class="keyword">else</span>
                <span class="comment">% Otherwise, if nX &gt;= nY, then pad the y-data.</span>
                obj.YData_(end+1:nX, 1) = NaN;
            <span class="keyword">end</span> <span class="comment">% if</span>

            <span class="comment">% Set the internal x-data.</span>
            obj.XData_ = value;

            <span class="comment">% Reset the scatter series' color and size data if necessary.</span>
            nC = height( obj.CData );
            <span class="keyword">if</span> nC &gt; 1 &amp;&amp; nX ~= nC
                obj.CData = obj.Axes.ColorOrder(1, :);
            <span class="keyword">end</span> <span class="comment">% if</span>
            nS = numel( obj.SizeData );
            <span class="keyword">if</span> nS &gt; 1 &amp;&amp; nX ~= nS
                obj.SizeData = 36;
            <span class="keyword">end</span> <span class="comment">% if</span>

        <span class="keyword">end</span> <span class="comment">% set.XData</span>

        <span class="keyword">function</span> value = get.YData( obj )

            value = obj.YData_;

        <span class="keyword">end</span> <span class="comment">% get.YData</span>

        <span class="keyword">function</span> set.YData( obj, value )

            <span class="comment">% Mark the chart for an update.</span>
            obj.ComputationRequired = true;

            <span class="comment">% Decide how to modify the chart data.</span>
            nY = numel( value );
            nX = numel( obj.XData_ );

            <span class="keyword">if</span> nY &lt; nX <span class="comment">% If the new y-data is too short ...</span>
                <span class="comment">% ... then chop the chart x-data.</span>
                obj.XData_ = obj.XData_(1:nY);
            <span class="keyword">else</span>
                <span class="comment">% Otherwise, if nY &gt;= nX, then pad the x-data.</span>
                obj.XData_(end+1:nY, 1) = NaN;
            <span class="keyword">end</span> <span class="comment">% if</span>

            <span class="comment">% Set the internal y-data.</span>
            obj.YData_ = value;

            <span class="comment">% Reset the color and size data if necessary.</span>
            nC = height( obj.CData );
            <span class="keyword">if</span> nC &gt; 1 &amp;&amp; nY ~= nC
                obj.CData = obj.Axes.ColorOrder(1, :);
            <span class="keyword">end</span> <span class="comment">% if</span>
            nS = numel( obj.SizeData );
            <span class="keyword">if</span> nS &gt; 1 &amp;&amp; nY ~= nS
                obj.SizeData = 36;
            <span class="keyword">end</span> <span class="comment">% if</span>

        <span class="keyword">end</span> <span class="comment">% set.YData</span>

    <span class="keyword">end</span> <span class="comment">% methods</span>

    <span class="keyword">methods</span>

        <span class="keyword">function</span> obj = RangefinderChart( namedArgs )
            <span class="comment">%RANGEFINDERCHART Construct a RangefinderChart object, given</span>
            <span class="comment">%optional name-value arguments.</span>

            <span class="keyword">arguments</span> ( Input )
                namedArgs.?RangefinderChart
            <span class="keyword">end</span> <span class="comment">% arguments ( Input )</span>

            <span class="comment">% Set any user-defined properties.</span>
            set( obj, namedArgs )

        <span class="keyword">end</span> <span class="comment">% constructor</span>

        <span class="keyword">function</span> varargout = xlabel( obj, varargin )

            [varargout{1:nargout}] = xlabel( obj.Axes, varargin{:} );

        <span class="keyword">end</span> <span class="comment">% xlabel</span>

        <span class="keyword">function</span> varargout = ylabel( obj, varargin )

            [varargout{1:nargout}] = ylabel( obj.Axes, varargin{:} );

        <span class="keyword">end</span> <span class="comment">% ylabel</span>

        <span class="keyword">function</span> varargout = title( obj, varargin )

            [varargout{1:nargout}] = title( obj.Axes, varargin{:} );

        <span class="keyword">end</span> <span class="comment">% title</span>

        <span class="keyword">function</span> varargout = axis( obj, varargin )

            [varargout{1:nargout}] = axis( obj.Axes, varargin{:} );

        <span class="keyword">end</span> <span class="comment">% axis</span>

    <span class="keyword">end</span> <span class="comment">% methods</span>

    <span class="keyword">methods</span> ( Access = protected )

        <span class="keyword">function</span> setup( obj )
            <span class="comment">%SETUP Initialize the chart graphics.</span>

            <span class="comment">% Create the chart's axes.</span>
            obj.Axes = axes( <span class="string">"Parent"</span>, obj.getLayout() );

            <span class="comment">% Initialize the scatter plot.</span>
            obj.ScatterSeries = scatter( obj.Axes, NaN, NaN );

            <span class="comment">% Next, create the median crossover. This comprises two</span>
            <span class="comment">% perpendicular line segments with markers at their crossover</span>
            <span class="comment">% point.</span>
            crossoverMarkers = [<span class="string">"none"</span>, <span class="string">"none"</span>, <span class="string">"o"</span>, <span class="string">"x"</span>];
            crossoverMarkerSizes = [6, 6, 20, 20];
            lineWidths = [obj.LineWidth, obj.LineWidth, 2, 2];
            <span class="keyword">for</span> k = 1 : 4
                obj.MedianCrossoverLines(k) = line( <span class="keyword">...</span>
                    <span class="string">"Parent"</span>, obj.Axes, <span class="keyword">...</span>
                    <span class="string">"XData"</span>, NaN, <span class="keyword">...</span>
                    <span class="string">"YData"</span>, NaN, <span class="keyword">...</span>
                    <span class="string">"Marker"</span>, crossoverMarkers(k), <span class="keyword">...</span>
                    <span class="string">"MarkerSize"</span>, crossoverMarkerSizes(k), <span class="keyword">...</span>
                    <span class="string">"LineWidth"</span>, lineWidths(k) );
            <span class="keyword">end</span> <span class="comment">% for</span>

            hold( obj.Axes, <span class="string">"on"</span> )

            <span class="keyword">for</span> k = 1 : 4

                <span class="comment">% Create the line segments for the adjacent values.</span>
                obj.AdjacentLines(k) = plot( obj.Axes, NaN, NaN, <span class="keyword">...</span>
                    <span class="string">"LineWidth"</span>, obj.LineWidth );

                <span class="comment">% Define the labels for the custom datatips.</span>
                <span class="keyword">if</span> k &lt;= 2
                    lbl = <span class="string">"(x):"</span>;
                <span class="keyword">else</span>
                    lbl = <span class="string">"(y):"</span>;
                <span class="keyword">end</span> <span class="comment">% if</span>

                obj.AdjacentLines(k).DataTipTemplate. <span class="keyword">...</span>
                    DataTipRows(1).Label = <span class="string">"Lower adjacent value "</span> + lbl;
                obj.AdjacentLines(k).DataTipTemplate. <span class="keyword">...</span>
                    DataTipRows(2).Label = <span class="string">"Lower quartile "</span> + lbl;
                obj.AdjacentLines(k).DataTipTemplate. <span class="keyword">...</span>
                    DataTipRows(3).Label = <span class="string">"Median "</span> + lbl;
                obj.AdjacentLines(k).DataTipTemplate. <span class="keyword">...</span>
                    DataTipRows(4).Label = <span class="string">"Upper quartile "</span> + lbl;
                obj.AdjacentLines(k).DataTipTemplate. <span class="keyword">...</span>
                    DataTipRows(5).Label = <span class="string">"Upper adjacent value "</span> + lbl;
                obj.AdjacentLines(k).DataTipTemplate. <span class="keyword">...</span>
                    DataTipRows(6).Label = <span class="string">"Interquartile range "</span> + lbl;

            <span class="keyword">end</span> <span class="comment">% for</span>

            hold( obj.Axes, <span class="string">"off"</span> )

        <span class="keyword">end</span> <span class="comment">% setup</span>

        <span class="keyword">function</span> update( obj )
            <span class="comment">%UPDATE Refresh the chart graphics.</span>

            <span class="keyword">if</span> obj.ComputationRequired

                <span class="comment">% Update the scatter plot.</span>
                set( obj.ScatterSeries, <span class="string">"XData"</span>, obj.XData_, <span class="keyword">...</span>
                    <span class="string">"YData"</span>, obj.YData_ )

                <span class="comment">% Compute the marginal quartiles.</span>
                qx = quantile( obj.XData_, [0.25, 0.50, 0.75] );
                qy = quantile( obj.YData_, [0.25, 0.50, 0.75] );

                <span class="comment">% Compute the interquartile ranges.</span>
                iqrx = qx(3) - qx(1);
                iqry = qy(3) - qy(1);

                <span class="comment">% Update the median crossover graphics.</span>
                set( obj.MedianCrossoverLines(1), <span class="keyword">...</span>
                    <span class="string">"XData"</span>, qx([1, 3]), <span class="keyword">...</span>
                    <span class="string">"YData"</span>, qy([2, 2]) )
                set( obj.MedianCrossoverLines(2), <span class="keyword">...</span>
                    <span class="string">"XData"</span>, qx([2, 2]), <span class="keyword">...</span>
                    <span class="string">"YData"</span>, qy([1, 3]) )
                set( obj.MedianCrossoverLines(3), <span class="keyword">...</span>
                    <span class="string">"XData"</span>, qx(2), <span class="keyword">...</span>
                    <span class="string">"YData"</span>, qy(2) )
                set( obj.MedianCrossoverLines(4), <span class="keyword">...</span>
                    <span class="string">"XData"</span>, qx(2), <span class="keyword">...</span>
                    <span class="string">"YData"</span>, qy(2) )

                <span class="comment">% Update the adjacent lines. To do this, we compute the</span>
                <span class="comment">% upper and lower limits.</span>
                xLimits = [qx(1)-1.5*iqrx, qx(3)+1.5*iqrx];
                yLimits = [qy(1)-1.5*iqry, qy(3)+1.5*iqry];
                internalxIdx = obj.XData_ &gt; xLimits(1) &amp; <span class="keyword">...</span>
                    obj.XData_ &lt; xLimits(2);
                internalyIdx = obj.YData_ &gt; yLimits(1) &amp; <span class="keyword">...</span>
                    obj.YData_ &lt; yLimits(2);
                adjx = [min(obj.XData_(internalxIdx)), <span class="keyword">...</span>
                    max(obj.XData_(internalxIdx))];
                adjy = [min(obj.YData_(internalyIdx)), <span class="keyword">...</span>
                    max(obj.YData_(internalyIdx))];

                <span class="comment">% Deal with the case when no adjacent values exist.</span>
                <span class="keyword">if</span> isempty( adjx )
                    adjx = NaN( 1, 2 );
                <span class="keyword">end</span> <span class="comment">% if</span>
                <span class="keyword">if</span> isempty( adjy )
                    adjy = NaN( 1, 2 );
                <span class="keyword">end</span> <span class="comment">% if</span>

                <span class="comment">% Update the adjacent lines.</span>
                set( obj.AdjacentLines(1), <span class="keyword">...</span>
                    <span class="string">"XData"</span>, [adjx(1), adjx(1)], <span class="keyword">...</span>
                    <span class="string">"YData"</span>, qy([1, 3]) )
                set( obj.AdjacentLines(2), <span class="keyword">...</span>
                    <span class="string">"XData"</span>, [adjx(2), adjx(2)], <span class="keyword">...</span>
                    <span class="string">"YData"</span>, qy([1, 3]) )
                set( obj.AdjacentLines(3), <span class="keyword">...</span>
                    <span class="string">"XData"</span>, qx([1, 3]), <span class="keyword">...</span>
                    <span class="string">"YData"</span>, [adjy(1), adjy(1)] )
                set( obj.AdjacentLines(4), <span class="keyword">...</span>
                    <span class="string">"XData"</span>, qx([1, 3]), <span class="keyword">...</span>
                    <span class="string">"YData"</span>, [adjy(2), adjy(2)] )

                <span class="comment">% Update the values in the custom datatips.</span>
                <span class="keyword">for</span> k = 1 : 4
                    <span class="keyword">if</span> k &lt;= 2
                        newTipVals = [adjx(1), qx, adjx(2), iqrx];
                    <span class="keyword">else</span>
                        newTipVals = [adjy(1), qy, adjy(2), iqry];
                    <span class="keyword">end</span> <span class="comment">% if</span>
                    <span class="keyword">for</span> kk = 1 : numel( newTipVals )
                        obj.AdjacentLines(k).DataTipTemplate. <span class="keyword">...</span>
                            DataTipRows(kk).Value = <span class="keyword">...</span>
                            newTipVals(kk) * [1, 1];
                    <span class="keyword">end</span> <span class="comment">% for</span>
                <span class="keyword">end</span> <span class="comment">% for</span>

                <span class="comment">% Mark the chart clean.</span>
                obj.ComputationRequired = false;

            <span class="keyword">end</span> <span class="comment">% if</span>

            <span class="comment">% Refresh the chart's decorative properties.</span>
            set( obj.ScatterSeries, <span class="string">"Marker"</span>, obj.Marker, <span class="keyword">...</span>
                <span class="string">"SizeData"</span>, obj.SizeData, <span class="keyword">...</span>
                <span class="string">"CData"</span>, obj.CData )
            set( obj.Axes, <span class="string">"XGrid"</span>, obj.XGrid, <span class="string">"YGrid"</span>, obj.YGrid )
            set( obj.AdjacentLines, <span class="keyword">...</span>
                <span class="string">"Color"</span>, obj.MedianCrossoverLines(1).Color )
            set( [obj.AdjacentLines; obj.MedianCrossoverLines(1:2)], <span class="keyword">...</span>
                <span class="string">"LineWidth"</span>, obj.LineWidth )

        <span class="keyword">end</span> <span class="comment">% update</span>

    <span class="keyword">end</span> <span class="comment">% methods ( Access = protected )</span>

<span class="keyword">end</span> <span class="comment">% classdef</span>
</pre>
</div>
<!--
##### SOURCE BEGIN #####
classdef RangefinderChart < Chart
    %RANGEFINDERCHART Rangefinder chart for bivariate scattered data.
    %The rangefinder chart displays a 2D scatter plot overlaid with a
    %marker at the crossover point of the marginal medians and lines
    %indicating the marginal adjacent values.

    % Copyright 2018-2025 The MathWorks, Inc.

    properties ( Dependent )
        % Chart x-data.
        XData(:, 1) double {mustBeReal}
        % Chart y-data.
        YData(:, 1) double {mustBeReal}
    end % properties ( Dependent )

    properties
        % Marker for the discrete plot.
        Marker(1, 1) string {mustBeMarker} = "o"
        % Size data for the discrete plot.
        SizeData(:, 1) double {mustBePositive, mustBeFinite} = 36
        % Color of the discrete plot.
        CData(:, 3) double {mustBeInRange( CData, 0, 1 )} = ...
            [0, 0.4470, 0.7410]
        % Axes x-grid.
        XGrid(1, 1) matlab.lang.OnOffSwitchState = "on"
        % Axes y-grid.
        YGrid(1, 1) matlab.lang.OnOffSwitchState = "on"
        % Width of the adjacent lines.
        LineWidth(1, 1) double {mustBePositive, mustBeFinite} = 3
    end % properties

    properties ( Access = private )
        % Internal storage for the XData property.
        XData_(:, 1) double {mustBeReal} = double.empty( 0, 1 )
        % Internal storage for the YData property.
        YData_(:, 1) double {mustBeReal} = double.empty( 0, 1 )
        % Logical scalar specifying whether a computation is required.
        ComputationRequired(1, 1) logical = false
    end % properties ( Access = private )

    properties ( Access = private, Transient, NonCopyable )
        % Chart axes.
        Axes(:, 1) matlab.graphics.axis.Axes {mustBeScalarOrEmpty}
        % Scatter series for the discrete bivariate data.
        ScatterSeries(:, 1) matlab.graphics.chart.primitive.Scatter ...
            {mustBeScalarOrEmpty}
        % Line objects used for the median crossover.
        MedianCrossoverLines(4, 1) matlab.graphics.primitive.Line
        % Line objects used for the adjacent values.
        AdjacentLines(4, 1) matlab.graphics.chart.primitive.Line
    end % properties ( Access = private, Transient, NonCopyable )

    properties ( Constant, Hidden )
        % Product dependencies.
        Dependencies(1, :) string = ["MATLAB", ...
            "Statistics and Machine Learning Toolbox"]
        % Description.
        ShortDescription(1, 1) string = "Bivariate scatter plot " + ...
            "showing the crossover point of the marginal medians" + ...
            " and lines indicating the marginal adjacent values"
    end % properties ( Constant, Hidden )

    methods

        function value = get.XData( obj )

            value = obj.XData_;

        end % get.XData

        function set.XData( obj, value )

            % Mark the chart for an update.
            obj.ComputationRequired = true;

            % Decide how to modify the chart data.
            nX = numel( value );
            nY = numel( obj.YData_ );

            if nX < nY % If the new x-data is too short ...
                % ... then chop the chart y-data.
                obj.YData_ = obj.YData_(1:nX);
            else
                % Otherwise, if nX >= nY, then pad the y-data.
                obj.YData_(end+1:nX, 1) = NaN;
            end % if

            % Set the internal x-data.
            obj.XData_ = value;

            % Reset the scatter series' color and size data if necessary.
            nC = height( obj.CData );
            if nC > 1 && nX ~= nC
                obj.CData = obj.Axes.ColorOrder(1, :);
            end % if
            nS = numel( obj.SizeData );
            if nS > 1 && nX ~= nS
                obj.SizeData = 36;
            end % if

        end % set.XData

        function value = get.YData( obj )

            value = obj.YData_;

        end % get.YData

        function set.YData( obj, value )

            % Mark the chart for an update.
            obj.ComputationRequired = true;

            % Decide how to modify the chart data.
            nY = numel( value );
            nX = numel( obj.XData_ );

            if nY < nX % If the new y-data is too short ...
                % ... then chop the chart x-data.
                obj.XData_ = obj.XData_(1:nY);
            else
                % Otherwise, if nY >= nX, then pad the x-data.
                obj.XData_(end+1:nY, 1) = NaN;
            end % if

            % Set the internal y-data.
            obj.YData_ = value;

            % Reset the color and size data if necessary.
            nC = height( obj.CData );
            if nC > 1 && nY ~= nC
                obj.CData = obj.Axes.ColorOrder(1, :);
            end % if
            nS = numel( obj.SizeData );
            if nS > 1 && nY ~= nS
                obj.SizeData = 36;
            end % if

        end % set.YData

    end % methods

    methods

        function obj = RangefinderChart( namedArgs )
            %RANGEFINDERCHART Construct a RangefinderChart object, given
            %optional name-value arguments.

            arguments ( Input )
                namedArgs.?RangefinderChart
            end % arguments ( Input )

            % Set any user-defined properties.
            set( obj, namedArgs )

        end % constructor

        function varargout = xlabel( obj, varargin )

            [varargout{1:nargout}] = xlabel( obj.Axes, varargin{:} );

        end % xlabel

        function varargout = ylabel( obj, varargin )

            [varargout{1:nargout}] = ylabel( obj.Axes, varargin{:} );

        end % ylabel

        function varargout = title( obj, varargin )

            [varargout{1:nargout}] = title( obj.Axes, varargin{:} );

        end % title

        function varargout = axis( obj, varargin )

            [varargout{1:nargout}] = axis( obj.Axes, varargin{:} );

        end % axis

    end % methods

    methods ( Access = protected )

        function setup( obj )
            %SETUP Initialize the chart graphics.

            % Create the chart's axes.
            obj.Axes = axes( "Parent", obj.getLayout() );

            % Initialize the scatter plot.
            obj.ScatterSeries = scatter( obj.Axes, NaN, NaN );

            % Next, create the median crossover. This comprises two
            % perpendicular line segments with markers at their crossover
            % point.
            crossoverMarkers = ["none", "none", "o", "x"];
            crossoverMarkerSizes = [6, 6, 20, 20];
            lineWidths = [obj.LineWidth, obj.LineWidth, 2, 2];
            for k = 1 : 4
                obj.MedianCrossoverLines(k) = line( ...
                    "Parent", obj.Axes, ...
                    "XData", NaN, ...
                    "YData", NaN, ...
                    "Marker", crossoverMarkers(k), ...
                    "MarkerSize", crossoverMarkerSizes(k), ...
                    "LineWidth", lineWidths(k) );
            end % for
            
            hold( obj.Axes, "on" )
            
            for k = 1 : 4
                
                % Create the line segments for the adjacent values.                        
                obj.AdjacentLines(k) = plot( obj.Axes, NaN, NaN, ...                    
                    "LineWidth", obj.LineWidth );                

                % Define the labels for the custom datatips.
                if k <= 2
                    lbl = "(x):";
                else
                    lbl = "(y):";
                end % if

                obj.AdjacentLines(k).DataTipTemplate. ...
                    DataTipRows(1).Label = "Lower adjacent value " + lbl;
                obj.AdjacentLines(k).DataTipTemplate. ...
                    DataTipRows(2).Label = "Lower quartile " + lbl;
                obj.AdjacentLines(k).DataTipTemplate. ...
                    DataTipRows(3).Label = "Median " + lbl;
                obj.AdjacentLines(k).DataTipTemplate. ...
                    DataTipRows(4).Label = "Upper quartile " + lbl;
                obj.AdjacentLines(k).DataTipTemplate. ...
                    DataTipRows(5).Label = "Upper adjacent value " + lbl;
                obj.AdjacentLines(k).DataTipTemplate. ...
                    DataTipRows(6).Label = "Interquartile range " + lbl;

            end % for

            hold( obj.Axes, "off" )
            
        end % setup

        function update( obj )
            %UPDATE Refresh the chart graphics.

            if obj.ComputationRequired

                % Update the scatter plot.
                set( obj.ScatterSeries, "XData", obj.XData_, ...
                    "YData", obj.YData_ )

                % Compute the marginal quartiles.
                qx = quantile( obj.XData_, [0.25, 0.50, 0.75] );
                qy = quantile( obj.YData_, [0.25, 0.50, 0.75] );

                % Compute the interquartile ranges.
                iqrx = qx(3) - qx(1);
                iqry = qy(3) - qy(1);

                % Update the median crossover graphics.
                set( obj.MedianCrossoverLines(1), ...
                    "XData", qx([1, 3]), ...
                    "YData", qy([2, 2]) )
                set( obj.MedianCrossoverLines(2), ...
                    "XData", qx([2, 2]), ...
                    "YData", qy([1, 3]) )
                set( obj.MedianCrossoverLines(3), ...
                    "XData", qx(2), ...
                    "YData", qy(2) )
                set( obj.MedianCrossoverLines(4), ...
                    "XData", qx(2), ...
                    "YData", qy(2) )

                % Update the adjacent lines. To do this, we compute the
                % upper and lower limits.
                xLimits = [qx(1)-1.5*iqrx, qx(3)+1.5*iqrx];
                yLimits = [qy(1)-1.5*iqry, qy(3)+1.5*iqry];
                internalxIdx = obj.XData_ > xLimits(1) & ...
                    obj.XData_ < xLimits(2);
                internalyIdx = obj.YData_ > yLimits(1) & ...
                    obj.YData_ < yLimits(2);
                adjx = [min(obj.XData_(internalxIdx)), ...
                    max(obj.XData_(internalxIdx))];
                adjy = [min(obj.YData_(internalyIdx)), ...
                    max(obj.YData_(internalyIdx))];

                % Deal with the case when no adjacent values exist.
                if isempty( adjx )
                    adjx = NaN( 1, 2 );
                end % if
                if isempty( adjy )
                    adjy = NaN( 1, 2 );
                end % if

                % Update the adjacent lines.
                set( obj.AdjacentLines(1), ...
                    "XData", [adjx(1), adjx(1)], ...
                    "YData", qy([1, 3]) )
                set( obj.AdjacentLines(2), ...
                    "XData", [adjx(2), adjx(2)], ...
                    "YData", qy([1, 3]) )
                set( obj.AdjacentLines(3), ...
                    "XData", qx([1, 3]), ...
                    "YData", [adjy(1), adjy(1)] )
                set( obj.AdjacentLines(4), ...
                    "XData", qx([1, 3]), ...
                    "YData", [adjy(2), adjy(2)] )

                % Update the values in the custom datatips.
                for k = 1 : 4
                    if k <= 2
                        newTipVals = [adjx(1), qx, adjx(2), iqrx];
                    else
                        newTipVals = [adjy(1), qy, adjy(2), iqry];
                    end % if
                    for kk = 1 : numel( newTipVals )
                        obj.AdjacentLines(k).DataTipTemplate. ...
                            DataTipRows(kk).Value = ...
                            newTipVals(kk) * [1, 1];
                    end % for
                end % for

                % Mark the chart clean.
                obj.ComputationRequired = false;

            end % if

            % Refresh the chart's decorative properties.
            set( obj.ScatterSeries, "Marker", obj.Marker, ...
                "SizeData", obj.SizeData, ...
                "CData", obj.CData )
            set( obj.Axes, "XGrid", obj.XGrid, "YGrid", obj.YGrid )
            set( obj.AdjacentLines, ...
                "Color", obj.MedianCrossoverLines(1).Color )
            set( [obj.AdjacentLines; obj.MedianCrossoverLines(1:2)], ...
                "LineWidth", obj.LineWidth )

        end % update

    end % methods ( Access = protected )

end % classdef
##### SOURCE END #####
-->
</body>
</html>
