<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
<!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      -->
<title>ClockChart</title>
<meta name="generator" content="MATLAB 25.1">
<link rel="schema.DC" href="http://purl.org/dc/elements/1.1/">
<meta name="DC.date" content="2025-01-11">
<meta name="DC.source" content="ClockChart.m">
<style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; }

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }
span.typesection { color:#A0522D }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style>
</head>
<body>
<div class="content">
<pre class="codeinput">
<span class="keyword">classdef</span> ClockChart &lt; Chart
    <span class="comment">%CLOCKCHART Display an analog clock, using a timer to schedule regular</span>
    <span class="comment">%updates.</span>

    <span class="comment">% Copyright 2024-2025 The MathWorks, Inc.</span>

    <span class="keyword">properties</span>
        ShowNumbers<span class="typesection">(1, 1) matlab.lang.OnOffSwitchState </span>= <span class="string">"on"</span>
    <span class="keyword">end</span> <span class="comment">% properties</span>

    <span class="keyword">properties</span> ( Access = private, Transient, NonCopyable )
        <span class="comment">% Chart axes.</span>
        Axes<span class="typesection">(:, 1) matlab.graphics.axis.Axes {mustBeScalarOrEmpty}</span>
        <span class="comment">% Line for the clock face edge.</span>
        ClockFaceEdge<span class="typesection">(:, 1) matlab.graphics.primitive.Line </span><span class="keyword">...</span>
            <span class="typesection">{mustBeScalarOrEmpty}</span>
        <span class="comment">% Text objects for the numbers.</span>
        ClockNumbers<span class="typesection">(:, 1) matlab.graphics.primitive.Text</span>
        <span class="comment">% Line objects for the minute markers.</span>
        MinuteMarkers<span class="typesection">(:, 1) matlab.graphics.primitive.Line</span>
        <span class="comment">% Line objects for the five-minute markers.</span>
        FiveMinuteMarkers<span class="typesection">(:, 1) matlab.graphics.primitive.Line</span>
        <span class="comment">% Patch object for the hour hand.</span>
        HourHand<span class="typesection">(:, 1) matlab.graphics.primitive.Patch </span><span class="keyword">...</span>
            <span class="typesection">{mustBeScalarOrEmpty}</span>
        <span class="comment">% Patch object for the minute hand.</span>
        MinuteHand<span class="typesection">(:, 1) matlab.graphics.primitive.Patch </span><span class="keyword">...</span>
            <span class="typesection">{mustBeScalarOrEmpty}</span>
        <span class="comment">% Patch object for the second hand.</span>
        SecondHand<span class="typesection">(:, 1) matlab.graphics.primitive.Patch </span><span class="keyword">...</span>
            <span class="typesection">{mustBeScalarOrEmpty}</span>
    <span class="keyword">end</span> <span class="comment">% properties ( Access = private, Transient, NonCopyable )</span>

    <span class="keyword">properties</span> ( Access = private )
        <span class="comment">% Timer object, used for the clock.</span>
        Timer<span class="typesection">(:, 1) timer {mustBeScalarOrEmpty}</span>
        <span class="comment">% Destruction listener, used to tidy up the timer.</span>
        DestructionListener<span class="typesection">(:, 1) event.listener {mustBeScalarOrEmpty}</span>
    <span class="keyword">end</span> <span class="comment">% properties ( Access = private )</span>

    <span class="keyword">properties</span> ( Constant, Hidden )
        <span class="comment">% Product dependencies.</span>
        Dependencies<span class="typesection">(1, :) string </span>= <span class="string">"MATLAB"</span>
        <span class="comment">% Description.</span>
        ShortDescription<span class="typesection">(1, 1) string </span>= <span class="string">"Display an analog clock,"</span> + <span class="keyword">...</span>
            <span class="string">" using a timer to schedule regular updates"</span>
    <span class="keyword">end</span> <span class="comment">% properties ( Constant, Hidden )</span>

    <span class="keyword">methods</span>

        <span class="keyword">function</span> obj = ClockChart( namedArgs )
            <span class="comment">%CLOCKCHART Construct a ClockChart object, given optional</span>
            <span class="comment">%name-value arguments.</span>

            <span class="keyword">arguments</span> ( Input )
                namedArgs.?ClockChart
            <span class="keyword">end</span> <span class="comment">% arguments ( Input )</span>

            <span class="comment">% Create the timer.</span>
            obj.Timer = timer( <span class="string">"Period"</span>, 1, <span class="keyword">...</span>
                <span class="string">"ExecutionMode"</span>, <span class="string">"fixedRate"</span>, <span class="keyword">...</span>
                <span class="string">"TimerFcn"</span>, @obj.onTick );

            <span class="comment">% Start the timer.</span>
            start( obj.Timer )

            <span class="comment">% Create a listener to delete the timer when the chart is</span>
            <span class="comment">% deleted.</span>
            weakObj = matlab.lang.WeakReference( obj );
            callback = @( varargin ) weakObj.Handle.onChartDeleted( <span class="keyword">...</span>
                varargin{:} );
            obj.DestructionListener = listener( obj, <span class="keyword">...</span>
                <span class="string">"ObjectBeingDestroyed"</span>, callback );

            <span class="comment">% Set any user-specified properties.</span>
            set( obj, namedArgs )

        <span class="keyword">end</span> <span class="comment">% constructor</span>

    <span class="keyword">end</span> <span class="comment">% methods</span>

    <span class="keyword">methods</span> ( Access = protected )

        <span class="keyword">function</span> setup( obj )
            <span class="comment">%SETUP Initialize the chart graphics.</span>

            <span class="comment">% Create the axes.</span>
            obj.Axes = axes( <span class="string">"Parent"</span>, obj.getLayout(), <span class="keyword">...</span>
                <span class="string">"Visible"</span>, <span class="string">"off"</span>, <span class="keyword">...</span>
                <span class="string">"Toolbar"</span>, [], <span class="keyword">...</span>
                <span class="string">"Interactions"</span>, [], <span class="keyword">...</span>
                <span class="string">"XLim"</span>, [-10, 10], <span class="keyword">...</span>
                <span class="string">"YLim"</span>, [-10, 10], <span class="keyword">...</span>
                <span class="string">"DataAspectRatio"</span>, [1, 1, 1] );

            <span class="comment">% Draw the clock face edge.</span>
            t = linspace( 0, 2 * pi, 500 );
            obj.ClockFaceEdge = line( <span class="string">"Parent"</span>, obj.Axes, <span class="keyword">...</span>
                <span class="string">"XData"</span>, 9 * cos( t ), <span class="keyword">...</span>
                <span class="string">"YData"</span>, 9 * sin( t ), <span class="keyword">...</span>
                <span class="string">"LineWidth"</span>, 8 );

            <span class="comment">% Add the clock numbers.</span>
            clockNumberAngles = (60 : -30 : -270).'; <span class="comment">% 1-12 o'clock</span>
            obj.ClockNumbers = text( obj.Axes, <span class="keyword">...</span>
                7 * cosd( clockNumberAngles ), <span class="keyword">...</span>
                7 * sind( clockNumberAngles ), <span class="keyword">...</span>
                string( (1:12).' ), <span class="keyword">...</span>
                <span class="string">"HorizontalAlignment"</span>, <span class="string">"center"</span>, <span class="keyword">...</span>
                <span class="string">"VerticalAlignment"</span>, <span class="string">"middle"</span>, <span class="keyword">...</span>
                <span class="string">"FontName"</span>, <span class="string">"monospaced"</span>, <span class="keyword">...</span>
                <span class="string">"FontSize"</span>, 28 );

            <span class="comment">% Compute the minute and five-minute tick mark coordinates.</span>
            minuteAngles = (90 : -6 : -264);
            fiveMinuteAngles = minuteAngles(1:5:end);
            tickRadii = [8.1; 8.5];
            minutex = tickRadii * cosd( minuteAngles );
            minutey = tickRadii * sind( minuteAngles );
            fiveMinutex = tickRadii * cosd( fiveMinuteAngles );
            fiveMinutey = tickRadii * sind( fiveMinuteAngles );

            <span class="comment">% Add the minute markers.</span>
            <span class="keyword">for</span> k = 1 : width( minutex )
                obj.MinuteMarkers(k) = line( <span class="string">"Parent"</span>, obj.Axes, <span class="keyword">...</span>
                    <span class="string">"XData"</span>, minutex(:, k), <span class="keyword">...</span>
                    <span class="string">"YData"</span>, minutey(:, k), <span class="keyword">...</span>
                    <span class="string">"LineWidth"</span>, 3 );
            <span class="keyword">end</span> <span class="comment">% for</span>

            <span class="comment">% Add the five-minute markers.</span>
            <span class="keyword">for</span> k = 1 : width( fiveMinutex )
                obj.FiveMinuteMarkers(k) = line( <span class="string">"Parent"</span>, obj.Axes, <span class="keyword">...</span>
                    <span class="string">"XData"</span>, fiveMinutex(:, k), <span class="keyword">...</span>
                    <span class="string">"YData"</span>, fiveMinutey(:, k), <span class="keyword">...</span>
                    <span class="string">"LineWidth"</span>, 8 );
            <span class="keyword">end</span> <span class="comment">% for</span>

            <span class="comment">% Create patches for the hour, minute, and second hands.</span>
            obj.HourHand = patch( <span class="string">"Parent"</span>, obj.Axes, <span class="keyword">...</span>
                <span class="string">"XData"</span>, NaN, <span class="keyword">...</span>
                <span class="string">"YData"</span>, NaN, <span class="keyword">...</span>
                <span class="string">"EdgeAlpha"</span>, 0 );
            obj.MinuteHand = patch( <span class="string">"Parent"</span>, obj.Axes, <span class="keyword">...</span>
                <span class="string">"XData"</span>, NaN, <span class="keyword">...</span>
                <span class="string">"YData"</span>, NaN, <span class="keyword">...</span>
                <span class="string">"EdgeAlpha"</span>, 0 );
            obj.SecondHand = patch( <span class="string">"Parent"</span>, obj.Axes, <span class="keyword">...</span>
                <span class="string">"XData"</span>, NaN, <span class="keyword">...</span>
                <span class="string">"YData"</span>, NaN, <span class="keyword">...</span>
                <span class="string">"EdgeAlpha"</span>, 0, <span class="keyword">...</span>
                <span class="string">"FaceColor"</span>, <span class="string">"r"</span> );

        <span class="keyword">end</span> <span class="comment">% setup</span>

        <span class="keyword">function</span> update( obj )
            <span class="comment">%UPDATE Refresh the chart graphics.</span>

            <span class="comment">% Update the hands.</span>
            set( [obj.HourHand, obj.MinuteHand], <span class="keyword">...</span>
                <span class="string">"FaceColor"</span>, obj.ClockFaceEdge.Color )

            <span class="comment">% Update the numbers.</span>
            set( obj.ClockNumbers, <span class="string">"Visible"</span>, obj.ShowNumbers )

        <span class="keyword">end</span> <span class="comment">% update</span>

    <span class="keyword">end</span> <span class="comment">% methods ( Access = protected )</span>

    <span class="keyword">methods</span> ( Access = private )

        <span class="keyword">function</span> onChartDeleted( obj, ~, ~ )
            <span class="comment">%ONCHARTDELETED Respond to the destruction of the chart by</span>
            <span class="comment">%tidying up the timer object.</span>

            <span class="keyword">if</span> obj.Timer.Running == <span class="string">"on"</span>
                stop( obj.Timer )
            <span class="keyword">end</span> <span class="comment">% if</span>

            delete( obj.Timer )

        <span class="keyword">end</span> <span class="comment">% onChartDeleted</span>

        <span class="keyword">function</span> onTick( obj, ~, ~ )
            <span class="comment">%ONTICK Timer callback.</span>

            <span class="comment">% Record the current time.</span>
            t = datetime( <span class="string">"now"</span> );

            <span class="comment">% Compute the hand coordinates.</span>
            [hourHand, minuteHand, secondHand] = handxy( t );

            <span class="comment">% Update the hands.</span>
            set( obj.HourHand, <span class="string">"XData"</span>, hourHand(:, 1), <span class="keyword">...</span>
                <span class="string">"YData"</span>, hourHand(:, 2) )
            set( obj.MinuteHand, <span class="string">"XData"</span>, minuteHand(:, 1), <span class="keyword">...</span>
                <span class="string">"YData"</span>, minuteHand(:, 2) )
            set( obj.SecondHand, <span class="string">"XData"</span>, secondHand(:, 1), <span class="keyword">...</span>
                <span class="string">"YData"</span>, secondHand(:, 2) )

        <span class="keyword">end</span> <span class="comment">% onTick</span>

    <span class="keyword">end</span> <span class="comment">% methods ( Access = private )</span>

<span class="keyword">end</span> <span class="comment">% classdef</span>

<span class="keyword">function</span> [hourHand, minuteHand, secondHand] = handxy( t )
<span class="comment">%HANDXY Compute (x, y) coordinates of the hour, minute, and second hands of</span>
<span class="comment">%the clock given the current time (t).</span>

<span class="keyword">arguments</span> ( Input )
    t<span class="typesection">(1, 1) datetime</span>
<span class="keyword">end</span> <span class="comment">% arguments ( Input )</span>

<span class="keyword">arguments</span> ( Output )
    hourHand<span class="typesection">(:, 2) double {mustBeReal, mustBeFinite}</span>
    minuteHand<span class="typesection">(:, 2) double {mustBeReal, mustBeFinite}</span>
    secondHand<span class="typesection">(:, 2) double {mustBeReal, mustBeFinite}</span>
<span class="keyword">end</span> <span class="comment">% arguments ( Output )</span>

<span class="comment">% Initialize the clock hand dimensions (front/back length, front/back</span>
<span class="comment">% width).</span>
<span class="keyword">persistent</span> handDimensions distanceToOrigin inverseTangent

<span class="keyword">if</span> isempty( handDimensions )
    handDimensions = [5, 5/3, 0.1, 0.3;
        7, 7/3, 0.1, 0.3;
        7, 7/3, 0.05, 0.15];
<span class="keyword">end</span> <span class="comment">% if</span>

<span class="keyword">if</span> isempty( distanceToOrigin )
    distanceToOrigin = [hypot( handDimensions(:, 1), <span class="keyword">...</span>
        handDimensions(:, 3) ), hypot( handDimensions(:, 2), <span class="keyword">...</span>
        handDimensions(:, 4) )];
<span class="keyword">end</span> <span class="comment">% if</span>

<span class="keyword">if</span> isempty( inverseTangent )
    inverseTangent = atan( [handDimensions(:, 3) ./ <span class="keyword">...</span>
        handDimensions(:, 1), handDimensions(:, 4) ./ <span class="keyword">...</span>
        handDimensions(:, 2)] );
<span class="keyword">end</span> <span class="comment">% if</span>

<span class="comment">% Define the conversion factor from degrees to radians (pi/180), in the</span>
<span class="comment">% clockwise direction (-1).</span>
f = (-1) * pi/180;

<span class="comment">% Write down the hand angles based on the current time.</span>
hourHandAngle = f * (-90 + 30 * t.Hour + (30 * t.Minute) / 60 );
minuteHandAngle = f * (-90 + 6 * t.Minute + (6 * t.Second) / 60);
secondHandAngle = f * (-90 + 6 * t.Second);

<span class="comment">% Compute the (x, y) hand coordinates given the hand angle and dimensions.</span>
hourHand = xy( hourHandAngle, distanceToOrigin(1, :), <span class="keyword">...</span>
    handDimensions(1, :), inverseTangent(1, :) );
minuteHand = xy( minuteHandAngle, distanceToOrigin(2, :), <span class="keyword">...</span>
    handDimensions(2, :), inverseTangent(2, :) );
secondHand = xy( secondHandAngle, distanceToOrigin(3, :), <span class="keyword">...</span>
    handDimensions(3, :), inverseTangent(3, :) );

    <span class="keyword">function</span> coords = xy( theta, d, dims, invTan )
        <span class="comment">%XY Hand coordinate calculator, given the hand angle (theta),</span>
        <span class="comment">%distances to the origin (d), the hand dimensions (dims), and the</span>
        <span class="comment">%inverse tangents of the hand dimensions (invTan).</span>

        coords = [[d(1) * cos( theta + invTan(1) ); <span class="keyword">...</span>
              (dims(1) + 5 * dims(3)) * cos( theta ); <span class="keyword">...</span>
              d(1) * cos( theta - invTan(1) ); <span class="keyword">...</span>
              d(2) * cos( theta + invTan(2) + pi );<span class="keyword">...</span>
              d(2) * cos( theta - invTan(2) + pi )], <span class="keyword">...</span>
              [d(1) * sin( theta + invTan(1) ); <span class="keyword">...</span>
              (dims(1) + 5 * dims(3)) * sin( theta ); <span class="keyword">...</span>
              d(1) * sin( theta - invTan(1) ); <span class="keyword">...</span>
              d(2) * sin( theta + invTan(2) + pi ); <span class="keyword">...</span>
              d(2) * sin( theta - invTan(2) + pi )]];

    <span class="keyword">end</span> <span class="comment">% xy</span>

<span class="keyword">end</span> <span class="comment">% handxy</span>
</pre>
</div>
<!--
##### SOURCE BEGIN #####
classdef ClockChart < Chart
    %CLOCKCHART Display an analog clock, using a timer to schedule regular
    %updates.

    % Copyright 2024-2025 The MathWorks, Inc.

    properties
        ShowNumbers(1, 1) matlab.lang.OnOffSwitchState = "on"
    end % properties

    properties ( Access = private, Transient, NonCopyable )
        % Chart axes.
        Axes(:, 1) matlab.graphics.axis.Axes {mustBeScalarOrEmpty}
        % Line for the clock face edge.
        ClockFaceEdge(:, 1) matlab.graphics.primitive.Line ...
            {mustBeScalarOrEmpty}
        % Text objects for the numbers.
        ClockNumbers(:, 1) matlab.graphics.primitive.Text
        % Line objects for the minute markers.
        MinuteMarkers(:, 1) matlab.graphics.primitive.Line
        % Line objects for the five-minute markers.
        FiveMinuteMarkers(:, 1) matlab.graphics.primitive.Line
        % Patch object for the hour hand.
        HourHand(:, 1) matlab.graphics.primitive.Patch ...
            {mustBeScalarOrEmpty}
        % Patch object for the minute hand.
        MinuteHand(:, 1) matlab.graphics.primitive.Patch ...
            {mustBeScalarOrEmpty}
        % Patch object for the second hand.
        SecondHand(:, 1) matlab.graphics.primitive.Patch ...
            {mustBeScalarOrEmpty}
    end % properties ( Access = private, Transient, NonCopyable )

    properties ( Access = private )
        % Timer object, used for the clock.
        Timer(:, 1) timer {mustBeScalarOrEmpty}
        % Destruction listener, used to tidy up the timer.
        DestructionListener(:, 1) event.listener {mustBeScalarOrEmpty}
    end % properties ( Access = private )

    properties ( Constant, Hidden )
        % Product dependencies.
        Dependencies(1, :) string = "MATLAB"
        % Description.
        ShortDescription(1, 1) string = "Display an analog clock," + ...
            " using a timer to schedule regular updates"
    end % properties ( Constant, Hidden )

    methods

        function obj = ClockChart( namedArgs )
            %CLOCKCHART Construct a ClockChart object, given optional
            %name-value arguments.

            arguments ( Input )
                namedArgs.?ClockChart
            end % arguments ( Input )            

            % Create the timer.
            obj.Timer = timer( "Period", 1, ...
                "ExecutionMode", "fixedRate", ...
                "TimerFcn", @obj.onTick );

            % Start the timer.
            start( obj.Timer )

            % Create a listener to delete the timer when the chart is
            % deleted.
            weakObj = matlab.lang.WeakReference( obj );
            callback = @( varargin ) weakObj.Handle.onChartDeleted( ...
                varargin{:} );
            obj.DestructionListener = listener( obj, ...
                "ObjectBeingDestroyed", callback );

            % Set any user-specified properties.
            set( obj, namedArgs )

        end % constructor

    end % methods

    methods ( Access = protected )

        function setup( obj )
            %SETUP Initialize the chart graphics.

            % Create the axes.
            obj.Axes = axes( "Parent", obj.getLayout(), ...
                "Visible", "off", ...
                "Toolbar", [], ...
                "Interactions", [], ...
                "XLim", [-10, 10], ...
                "YLim", [-10, 10], ...
                "DataAspectRatio", [1, 1, 1] );

            % Draw the clock face edge.
            t = linspace( 0, 2 * pi, 500 );
            obj.ClockFaceEdge = line( "Parent", obj.Axes, ...
                "XData", 9 * cos( t ), ...
                "YData", 9 * sin( t ), ...
                "LineWidth", 8 );

            % Add the clock numbers.
            clockNumberAngles = (60 : -30 : -270).'; % 1-12 o'clock
            obj.ClockNumbers = text( obj.Axes, ...
                7 * cosd( clockNumberAngles ), ...
                7 * sind( clockNumberAngles ), ...
                string( (1:12).' ), ...
                "HorizontalAlignment", "center", ...
                "VerticalAlignment", "middle", ...
                "FontName", "monospaced", ...
                "FontSize", 28 );

            % Compute the minute and five-minute tick mark coordinates.
            minuteAngles = (90 : -6 : -264);
            fiveMinuteAngles = minuteAngles(1:5:end);
            tickRadii = [8.1; 8.5];
            minutex = tickRadii * cosd( minuteAngles );
            minutey = tickRadii * sind( minuteAngles );
            fiveMinutex = tickRadii * cosd( fiveMinuteAngles );
            fiveMinutey = tickRadii * sind( fiveMinuteAngles );

            % Add the minute markers.
            for k = 1 : width( minutex )
                obj.MinuteMarkers(k) = line( "Parent", obj.Axes, ...
                    "XData", minutex(:, k), ...
                    "YData", minutey(:, k), ...
                    "LineWidth", 3 );
            end % for

            % Add the five-minute markers.
            for k = 1 : width( fiveMinutex )
                obj.FiveMinuteMarkers(k) = line( "Parent", obj.Axes, ...
                    "XData", fiveMinutex(:, k), ...
                    "YData", fiveMinutey(:, k), ...
                    "LineWidth", 8 );
            end % for

            % Create patches for the hour, minute, and second hands.
            obj.HourHand = patch( "Parent", obj.Axes, ...
                "XData", NaN, ...
                "YData", NaN, ...
                "EdgeAlpha", 0 );
            obj.MinuteHand = patch( "Parent", obj.Axes, ...
                "XData", NaN, ...
                "YData", NaN, ...
                "EdgeAlpha", 0 );
            obj.SecondHand = patch( "Parent", obj.Axes, ...
                "XData", NaN, ...
                "YData", NaN, ...
                "EdgeAlpha", 0, ...
                "FaceColor", "r" );

        end % setup

        function update( obj )
            %UPDATE Refresh the chart graphics.

            % Update the hands.
            set( [obj.HourHand, obj.MinuteHand], ...
                "FaceColor", obj.ClockFaceEdge.Color )

            % Update the numbers.
            set( obj.ClockNumbers, "Visible", obj.ShowNumbers )

        end % update

    end % methods ( Access = protected )

    methods ( Access = private )

        function onChartDeleted( obj, ~, ~ )
            %ONCHARTDELETED Respond to the destruction of the chart by
            %tidying up the timer object.

            if obj.Timer.Running == "on"
                stop( obj.Timer )
            end % if

            delete( obj.Timer )

        end % onChartDeleted

        function onTick( obj, ~, ~ )
            %ONTICK Timer callback.

            % Record the current time.
            t = datetime( "now" );

            % Compute the hand coordinates.
            [hourHand, minuteHand, secondHand] = handxy( t );

            % Update the hands.
            set( obj.HourHand, "XData", hourHand(:, 1), ...
                "YData", hourHand(:, 2) )
            set( obj.MinuteHand, "XData", minuteHand(:, 1), ...
                "YData", minuteHand(:, 2) )
            set( obj.SecondHand, "XData", secondHand(:, 1), ...
                "YData", secondHand(:, 2) )

        end % onTick

    end % methods ( Access = private )

end % classdef

function [hourHand, minuteHand, secondHand] = handxy( t )
%HANDXY Compute (x, y) coordinates of the hour, minute, and second hands of
%the clock given the current time (t).

arguments ( Input )
    t(1, 1) datetime
end % arguments ( Input )

arguments ( Output )
    hourHand(:, 2) double {mustBeReal, mustBeFinite}
    minuteHand(:, 2) double {mustBeReal, mustBeFinite}
    secondHand(:, 2) double {mustBeReal, mustBeFinite}
end % arguments ( Output )

% Initialize the clock hand dimensions (front/back length, front/back
% width).
persistent handDimensions distanceToOrigin inverseTangent

if isempty( handDimensions )
    handDimensions = [5, 5/3, 0.1, 0.3;
        7, 7/3, 0.1, 0.3;
        7, 7/3, 0.05, 0.15];
end % if

if isempty( distanceToOrigin )
    distanceToOrigin = [hypot( handDimensions(:, 1), ...
        handDimensions(:, 3) ), hypot( handDimensions(:, 2), ...
        handDimensions(:, 4) )];
end % if

if isempty( inverseTangent )
    inverseTangent = atan( [handDimensions(:, 3) ./ ...
        handDimensions(:, 1), handDimensions(:, 4) ./ ...
        handDimensions(:, 2)] );
end % if

% Define the conversion factor from degrees to radians (pi/180), in the 
% clockwise direction (-1).
f = (-1) * pi/180;

% Write down the hand angles based on the current time.
hourHandAngle = f * (-90 + 30 * t.Hour + (30 * t.Minute) / 60 );
minuteHandAngle = f * (-90 + 6 * t.Minute + (6 * t.Second) / 60);
secondHandAngle = f * (-90 + 6 * t.Second);

% Compute the (x, y) hand coordinates given the hand angle and dimensions.
hourHand = xy( hourHandAngle, distanceToOrigin(1, :), ...
    handDimensions(1, :), inverseTangent(1, :) );
minuteHand = xy( minuteHandAngle, distanceToOrigin(2, :), ...
    handDimensions(2, :), inverseTangent(2, :) );
secondHand = xy( secondHandAngle, distanceToOrigin(3, :), ...
    handDimensions(3, :), inverseTangent(3, :) );

    function coords = xy( theta, d, dims, invTan )
        %XY Hand coordinate calculator, given the hand angle (theta),
        %distances to the origin (d), the hand dimensions (dims), and the
        %inverse tangents of the hand dimensions (invTan).

        coords = [[d(1) * cos( theta + invTan(1) ); ...
              (dims(1) + 5 * dims(3)) * cos( theta ); ...
              d(1) * cos( theta - invTan(1) ); ...
              d(2) * cos( theta + invTan(2) + pi );...
              d(2) * cos( theta - invTan(2) + pi )], ...
              [d(1) * sin( theta + invTan(1) ); ...
              (dims(1) + 5 * dims(3)) * sin( theta ); ...
              d(1) * sin( theta - invTan(1) ); ...
              d(2) * sin( theta + invTan(2) + pi ); ...
              d(2) * sin( theta - invTan(2) + pi )]];

    end % xy

end % handxy
##### SOURCE END #####
-->
</body>
</html>
